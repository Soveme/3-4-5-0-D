<!doctype html>
<html lang="ru">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>FinGuide</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
        <link rel="stylesheet" href="/static/main.css" type="text/css">
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    </head>

    <body>

        <header class="sticky-top">
            <div class="container head-con">
                <div class="row head-row">
                    <div class="col-2 head-text">
                        <button class="btn btn-toggle">
                            <svg xmlns="http://www.w3.org/2000/svg" width="100%" viewBox="0 -960 960 960" fill="var(--bs-body-color)"><path d="M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z"/></svg>
                        </button>
                    </div>
                    <div class="col-8 head-text"><h1>FinGuide</h1></div>
                    <div class="col-2 head-text">
                        <button class="btn btn-toggle">
                            <a href="/users/me">
                                <svg xmlns="http://www.w3.org/2000/svg" width="100%" viewBox="0 -960 960 960"  fill="var(--bs-body-color)"><path d="M234-276q51-39 114-61.5T480-360q69 0 132 22.5T726-276q35-41 54.5-93T800-480q0-133-93.5-226.5T480-800q-133 0-226.5 93.5T160-480q0 59 19.5 111t54.5 93Zm246-164q-59 0-99.5-40.5T340-580q0-59 40.5-99.5T480-720q59 0 99.5 40.5T620-580q0 59-40.5 99.5T480-440Zm0 360q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q53 0 100-15.5t86-44.5q-39-29-86-44.5T480-280q-53 0-100 15.5T294-220q39 29 86 44.5T480-160Zm0-360q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm0-60Zm0 360Z"/></svg>
                            </a>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <div class="menu">
            
        </div>

        <div class="balls">
            <div class="ball-1 ball"></div>
            <div class="ball-2 ball"></div>
            <div class="ball-3 ball"></div>
        </div>

        <main class="sticky">
            <div class="container body-con">
                {% for group in groups%}
                <!-- один виджет -->
                <div class="row new-group">
                    <button class="btn btn-block">
                        <div class="col volume">
                                <a href="/history/{{group['id']}}" class="row">
                                    <div class="col-2"><svg xmlns="http://www.w3.org/2000/svg" class="svg-block" width="100%" viewBox="0 -960 960 960"  fill="var(--bs-body-color)"><path d="M280-120v-120h-80v-80h80v-80h-80v-80h80v-360h260q92 0 156 64t64 156q0 92-64 156t-156 64H360v80h160v80H360v120h-80Zm80-360h180q58 0 99-41t41-99q0-58-41-99t-99-41H360v280Z"/></svg></div>

                                    <div class="col-10">
                                        <div class="row block-text">{{group["name"]}}</div>
                                        <div class="row block-text">{{group["balance"]}} ₽</div>
                                    </div>

                                    <a href="/group/{{group['id']}}" class="col-2 settings-row">


                                        <div class="row">

                                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" fill="var(--bs-body-color)"><path d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"/></svg>

                                        </div>
                                        <div class="row invisible">s</div>
                                    </a>
                                </a>
                        </div>
                    </button>
                </div>

                <div class="row mini-block">
                    <button class="btn btn-mini-block l">
                    <!-- доход -->
                    <div class="col volume">
                        <a href="/history/{{group['id']}}">
                            <div class="row">
                                <div class="col-6">

                                    <div class="row">Доход:</div>
                                    <div class="row">{{group["bud"]}} ₽</div>
                                    
                                </div>
                                <div class="col-6 p-0 flexy" style="height: 10vh;"><canvas id="miniChart{{group['id']}}0" style="height: 90%; width: 100%; "></canvas></div>
                            </div>
                        </a>
                    </div>
                    <!-- доход -->
                    </button>
                    <button class="btn btn-mini-block r">
                    <!-- расход -->
                    <div class="col volume">
                        <a href="/history/{{group['id']}}">
                            <div class="row">
                                <div class="col-6">

                                    <div class="row">Расход:</div>
                                    <div class="row">{{group["expense"]}} ₽</div>
                                    
                                </div>
                                <div class="col-6 p-0 flexy" style="height: 10vh;"><canvas id="miniChart{{group['id']}}1" style="height: 90%; width: 100%;"></canvas></div>
                            </div>
                        </a>
                    </div>
                    <!-- расход -->
                    </button>
                </div>
                <script>
	                // Тестовые данные: замени на свои при необходимости
                    const dataPoints = [100, 120, 115, 140, 160]; // Пример: возрастающий

                    const ctx = document.getElementById("miniChart{{group['id']}}0").getContext("2d");

                    // Выбор цвета: зелёный, если последний >= первого, иначе — красный
                    const color = (dataPoints[dataPoints.length - 1] >= dataPoints[0]) ? 'green' : 'red';

                    new Chart(ctx, {
                        type: "line",
                        data: {
                            labels: dataPoints.map((_, i) => i),
                            datasets: [{
                                data: dataPoints,
                                borderColor: color,
                                borderWidth: 4,
                                tension: 0.4,
                                pointRadius: .2,
                                fill: false
                            }]
                        },
                        options: {
                            responsive: false,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false },
                                tooltip: { enabled: false }
                            },
                            scales: {
                                x: { display: false },
                                y: { display: false }
                            }
                        }
                    });
                </script>

                <script>
                    // Тестовые данные: замени на свои при необходимости
                    const dataPoints1 = [160, 140, 115, 120, 100]; // Пример: возрастающий

                    const ctx1 = document.getElementById("miniChart{{group['id']}}1").getContext("2d");

                    // Выбор цвета: зелёный, если последний >= первого, иначе — красный
                    const color1 = (dataPoints1[dataPoints1.length - 1] >= dataPoints1[0]) ? 'green' : 'red';

                    new Chart(ctx1, {
                        type: "line",
                        data: {
                            labels: dataPoints1.map((_, i) => i),
                            datasets: [{
                                data: dataPoints1,
                                borderColor: color1,
                                borderWidth: 4,
                                tension: 0.4,
                                pointRadius: .2,
                                fill: false
                            }]
                        },
                        options: {
                            responsive: false,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false },
                                tooltip: { enabled: false }
                            },
                            scales: {
                                x: { display: false },
                                y: { display: false }
                            }
                        }
                    });
                </script>
                {% endfor %}
                <!-- до сюда -->
                
                <div class="row new-group">
                    <button class="btn btn-block">
                            <div class="col volume">
                                <a href="/groups/create">
                                    <div class="row">
                                    <div class="col-2">
                                        <svg xmlns="http://www.w3.org/2000/svg"  class="svg-block" width="100%" viewBox="0 -960 960 960"  fill="var(--bs-body-color)"><path d="M280-120v-120h-80v-80h80v-80h-80v-80h80v-360h260q92 0 156 64t64 156q0 92-64 156t-156 64H360v80h160v80H360v120h-80Zm80-360h180q58 0 99-41t41-99q0-58-41-99t-99-41H360v280Z"/></svg>
                                    </div>
                                    <div class="col-10"><h5 style="margin-bottom: 0; margin-left: 1em; text-align: left;">Откройте новый счет</h5></div>
                                    </div>
                                </a>
                            </div>
                    </button>
                </div>
            </div>
        </main>




        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>
    </body>


</html>